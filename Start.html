<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>使用Docker Cassandra | Cassandra 筆記</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/Cassandra/assets/css/0.styles.c433b53c.css" as="style"><link rel="preload" href="/Cassandra/assets/js/app.e2f0342c.js" as="script"><link rel="preload" href="/Cassandra/assets/js/2.2effd283.js" as="script"><link rel="preload" href="/Cassandra/assets/js/11.31e7f102.js" as="script"><link rel="prefetch" href="/Cassandra/assets/js/10.3fd2f61f.js"><link rel="prefetch" href="/Cassandra/assets/js/12.6cffe9c8.js"><link rel="prefetch" href="/Cassandra/assets/js/3.2762568d.js"><link rel="prefetch" href="/Cassandra/assets/js/4.f3628d87.js"><link rel="prefetch" href="/Cassandra/assets/js/5.89150edf.js"><link rel="prefetch" href="/Cassandra/assets/js/6.96203600.js"><link rel="prefetch" href="/Cassandra/assets/js/7.ecd9b75b.js"><link rel="prefetch" href="/Cassandra/assets/js/8.2c3d0573.js"><link rel="prefetch" href="/Cassandra/assets/js/9.e7bc7365.js">
    <link rel="stylesheet" href="/Cassandra/assets/css/0.styles.c433b53c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Cassandra/" class="home-link router-link-active"><!----> <span class="site-name">Cassandra 筆記</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Cassandra/" class="nav-link">首頁</a></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Cassandra/" class="nav-link">首頁</a></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Cassandra/" class="sidebar-link">Cassandra</a></li><li><a href="/Cassandra/Start.html" class="active sidebar-link">開始使用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Cassandra/Start.html#使用docker-cassandra" class="sidebar-link">使用Docker Cassandra</a></li><li class="sidebar-sub-header"><a href="/Cassandra/Start.html#建立-keyspace與table" class="sidebar-link">建立 keyspace與table</a></li><li class="sidebar-sub-header"><a href="/Cassandra/Start.html#net-core-基礎操作-crud" class="sidebar-link">.Net Core 基礎操作 CRUD</a></li><li class="sidebar-sub-header"><a href="/Cassandra/Start.html#批次執行-batch" class="sidebar-link">批次執行(batch)</a></li><li class="sidebar-sub-header"><a href="/Cassandra/Start.html#自動綁定-mapping" class="sidebar-link">自動綁定(mapping)</a></li><li class="sidebar-sub-header"><a href="/Cassandra/Start.html#分頁-paging" class="sidebar-link">分頁(paging)</a></li><li class="sidebar-sub-header"><a href="/Cassandra/Start.html#使用-linq-查詢" class="sidebar-link">使用 LINQ 查詢</a></li><li class="sidebar-sub-header"><a href="/Cassandra/Start.html#指定定查詢叢集" class="sidebar-link">指定定查詢叢集</a></li><li class="sidebar-sub-header"><a href="/Cassandra/Start.html#指定傳輸壓縮" class="sidebar-link">指定傳輸壓縮</a></li><li class="sidebar-sub-header"><a href="/Cassandra/Start.html#最終一致性層級設定" class="sidebar-link">最終一致性層級設定</a></li></ul></li><li><a href="/Cassandra/Security.html" class="sidebar-link">安全性</a></li><li><a href="/Cassandra/Consistency.html" class="sidebar-link">可調整的一致性</a></li><li><a href="/Cassandra/Dbeavergui.html" class="sidebar-link">GUI 管理介面</a></li><li><a href="/Cassandra/Other.html" class="sidebar-link">其他</a></li><li><a href="/Cassandra/Result.html" class="sidebar-link">相關資源</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="使用docker-cassandra"><a href="#使用docker-cassandra" aria-hidden="true" class="header-anchor">#</a> 使用Docker Cassandra</h2> <ul><li>執行</li></ul> <p><em><strong>docker run --name n1 -d -p 9042:9042 cassandra</strong></em></p> <p>即會開始下載 cassandra container 並執行。</p> <div class="tip custom-block"><p><a href="https://hub.docker.com/_/cassandra" title="Cassandra" target="_blank" rel="noopener noreferrer">Cassandra<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> Docker Hub</p></div> <ul><li>查看 cassandra container 執行狀態，輸入</li></ul> <p><em><strong>docker  ps</strong></em></p> <div class="language-bash extra-class"><pre class="language-bash"><code>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                                         NAMES
22306c43253d        cassandra           <span class="token string">&quot;docker-entrypoint.s…&quot;</span>   <span class="token number">5</span> hours ago         Up <span class="token number">2</span> seconds        <span class="token number">7000</span>-7001/tcp, <span class="token number">7199</span>/tcp, <span class="token number">9160</span>/tcp, <span class="token number">0.0</span>.0.0:9042   n1
</code></pre></div><p>預設的連線 Port 為 9042</p> <ul><li>進入 cassandra 的 container 執行</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> docker <span class="token builtin class-name">exec</span> -ti n1 /bin/bash
</code></pre></div><ul><li>更新套件庫，執行</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token function">apt-get</span> update
</code></pre></div><ul><li>安裝 vim 套件，執行</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token function">vim</span>
</code></pre></div><div class="tip custom-block"><p>vim 預設的字型樣式會看不清楚，我們可以這修改預設的字型樣式</p> <ol><li><p>cd ~</p></li> <li><p>vi .vimrc</p></li> <li><p>內容輸入</p> <p>syntax on</p> <p>colorscheme desert</p></li> <li><p>存擋 =&gt; 離開</p></li></ol></div> <ul><li>查看 cassandra.yaml 設定檔，執行</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token function">vi</span> /etc/cassandra/cassandra.yaml
</code></pre></div><div class="tip custom-block"><p>cassandra 設定檔<a href="http://cassandra.apache.org/doc/latest/configuration/cassandra_config_file.html" title="Cassandra Configuration File" target="_blank" rel="noopener noreferrer">Cassandra Configuration File<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <h2 id="建立-keyspace與table"><a href="#建立-keyspace與table" aria-hidden="true" class="header-anchor">#</a> 建立 keyspace與table</h2> <ul><li>進入 cassandra container 後,執行</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> cqlsh
</code></pre></div><div class="tip custom-block"><p>CQL用法參考 <a href="http://cassandra.apache.org/doc/latest/cql/index.html" title="Cassandra Query Language (CQL)" target="_blank" rel="noopener noreferrer">Cassandra Query Language (CQL)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <ul><li>建立 keyspace，執行</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> create keyspace myTest with <span class="token assign-left variable">replication</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'class'</span><span class="token builtin class-name">:</span><span class="token string">'SimpleStrategy'</span>,<span class="token string">'replication_factor'</span>:1<span class="token punctuation">}</span><span class="token punctuation">;</span>**_
</code></pre></div><div class="tip custom-block"><p>這是基本的建立 keyspace 的方式，更多建立的方式請參考 ....(待續)</p></div> <ul><li>查詢建立的 keyspace 是否建立完成，輸入</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> DESCRIBE keyspaces<span class="token punctuation">;</span>
mytest  system_schema  system_auth  system  system_distributed  system_traces
</code></pre></div><ul><li>使用 keyspace ,輸入</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> use myTest<span class="token punctuation">;</span>

</code></pre></div><ul><li>建立測試資料表，輸入</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> Create table <span class="token function">users</span> <span class="token punctuation">(</span>first_name text, last_name text ,primary key<span class="token punctuation">(</span>first_name<span class="token punctuation">))</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>查詢建立的 table 是否建立完成，輸入</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>DESCRIBE tables<span class="token punctuation">;</span>
    <span class="token function">users</span>
</code></pre></div><ul><li>查詢建立的 table schema ，輸入</li></ul> <p><em><strong>DESCRIBE users;</strong></em></p> <div class="language-bash extra-class"><pre class="language-bash"><code>CREATE TABLE mytest.users <span class="token punctuation">(</span>
    first_name text PRIMARY KEY,
    last_name text
<span class="token punctuation">)</span> WITH bloom_filter_fp_chance <span class="token operator">=</span> <span class="token number">0.01</span>
    AND caching <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'keys'</span><span class="token builtin class-name">:</span> <span class="token string">'ALL'</span>, <span class="token string">'rows_per_partition'</span><span class="token builtin class-name">:</span> <span class="token string">'NONE'</span><span class="token punctuation">}</span>
    AND comment <span class="token operator">=</span> <span class="token string">''</span>
    AND compaction <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'class'</span><span class="token builtin class-name">:</span> <span class="token string">'org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy'</span>, <span class="token string">'max_threshold'</span><span class="token builtin class-name">:</span> <span class="token string">'32'</span>, <span class="token string">'min_threshold'</span><span class="token builtin class-name">:</span> <span class="token string">'4'</span><span class="token punctuation">}</span>
    AND compression <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'chunk_length_in_kb'</span><span class="token builtin class-name">:</span> <span class="token string">'64'</span>, <span class="token string">'class'</span><span class="token builtin class-name">:</span> <span class="token string">'org.apache.cassandra.io.compress.LZ4Compressor'</span><span class="token punctuation">}</span>
    AND crc_check_chance <span class="token operator">=</span> <span class="token number">1.0</span>
    AND dclocal_read_repair_chance <span class="token operator">=</span> <span class="token number">0.1</span>
    AND default_time_to_live <span class="token operator">=</span> <span class="token number">0</span>
    AND gc_grace_seconds <span class="token operator">=</span> <span class="token number">864000</span>
    AND max_index_interval <span class="token operator">=</span> <span class="token number">2048</span>
    AND memtable_flush_period_in_ms <span class="token operator">=</span> <span class="token number">0</span>
    AND min_index_interval <span class="token operator">=</span> <span class="token number">128</span>
    AND read_repair_chance <span class="token operator">=</span> <span class="token number">0.0</span>
    AND speculative_retry <span class="token operator">=</span> <span class="token string">'99PERCENTILE'</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="net-core-基礎操作-crud"><a href="#net-core-基礎操作-crud" aria-hidden="true" class="header-anchor">#</a> .Net Core 基礎操作 CRUD</h2> <h3 id="安裝-net-drive"><a href="#安裝-net-drive" aria-hidden="true" class="header-anchor">#</a> 安裝 .Net Drive</h3> <p>開啟專案，安裝 <strong>cassandra-sharp</strong> nuget 套件</p> <div class="language-bash extra-class"><pre class="language-bash"><code>Install-Package cassandra-sharp -Version <span class="token number">3.7</span>.0
</code></pre></div><div class="tip custom-block"><p>Cassandra-sharp Drive 套件參考
<a href="https://www.nuget.org/packages/cassandra-sharp" target="_blank" rel="noopener noreferrer">[NuGet]<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="https://github.com/pchalamet/cassandra-sharp" target="_blank" rel="noopener noreferrer">[GetHub]<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="http://cassandra.apache.org/doc/latest/getting_started/drivers.html#c-net" target="_blank" rel="noopener noreferrer">[更多]<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <div class="warning custom-block"><p>Windows 上才能使用，Ｍac 需要設定其他東西，參考 ...(待放)</p></div> <h3 id="insert"><a href="#insert" aria-hidden="true" class="header-anchor">#</a> Insert</h3> <p><strong>目標</strong>：寫入資料到 keyspace:myTest,table=users</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 建立連線，使用預設的 port</span>
<span class="token keyword">var</span> cluster <span class="token operator">=</span> Cluster<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">AddContactPoints</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 選擇使用的 keyspace</span>
<span class="token keyword">var</span> session <span class="token operator">=</span> cluster<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span><span class="token string">&quot;myTest&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 準備 insert 資料</span>
<span class="token keyword">var</span> addData <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">Prepare</span><span class="token punctuation">(</span><span class="token string">&quot;Insert Into users (first_name,last_name) values (?,?)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 值綁定</span>
<span class="token keyword">var</span> statement <span class="token operator">=</span> addData<span class="token punctuation">.</span><span class="token function">Bind</span><span class="token punctuation">(</span><span class="token string">&quot;user1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;AA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//執行</span>
session<span class="token punctuation">.</span><span class="token function">ExecuteAsync</span><span class="token punctuation">(</span>statement<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Reault：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>cqlsh:mytest<span class="token operator">&gt;</span> <span class="token keyword">select</span> * from <span class="token function">users</span><span class="token punctuation">;</span>

 first_name <span class="token operator">|</span> last_name
------------+-----------
      user1 <span class="token operator">|</span>        AA

<span class="token punctuation">(</span><span class="token number">1</span> rows<span class="token punctuation">)</span>
</code></pre></div><h3 id="update"><a href="#update" aria-hidden="true" class="header-anchor">#</a> Update</h3> <p><strong>目標</strong>：更新 last_name</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 建立連線，使用預設的 port</span>
<span class="token keyword">var</span> cluster <span class="token operator">=</span> Cluster<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">AddContactPoints</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 選擇使用的 keyspace</span>
<span class="token keyword">var</span> session <span class="token operator">=</span> cluster<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span><span class="token string">&quot;myTest&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 準備 update 資料</span>
<span class="token keyword">var</span> updateData <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">Prepare</span><span class="token punctuation">(</span>&quot;Update users  <span class="token keyword">set</span> last_name<span class="token operator">=</span><span class="token operator">?</span> where first_name<span class="token operator">=</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 值綁定</span>
<span class="token keyword">var</span> statement <span class="token operator">=</span> updateData<span class="token punctuation">.</span><span class="token function">Bind</span><span class="token punctuation">(</span><span class="token string">&quot;BB&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;user1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//執行</span>
session<span class="token punctuation">.</span><span class="token function">ExecuteAsync</span><span class="token punctuation">(</span>statement<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Reault：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>cqlsh:mytest<span class="token operator">&gt;</span> <span class="token keyword">select</span> * from <span class="token function">users</span><span class="token punctuation">;</span>

 first_name <span class="token operator">|</span> last_name
------------+-----------
      user1 <span class="token operator">|</span>        BB

<span class="token punctuation">(</span><span class="token number">1</span> rows<span class="token punctuation">)</span>

</code></pre></div><h3 id="select"><a href="#select" aria-hidden="true" class="header-anchor">#</a> Select</h3> <p><strong>目標</strong>：查詢user1資料</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 建立連線，使用預設的 port</span>
<span class="token keyword">var</span> cluster <span class="token operator">=</span> Cluster<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
         <span class="token punctuation">.</span><span class="token function">AddContactPoints</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">)</span>
         <span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 選擇使用的 keyspace</span>
<span class="token keyword">var</span> session <span class="token operator">=</span> cluster<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span><span class="token string">&quot;myTest&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 準備 select 資料</span>
<span class="token keyword">var</span> selectData <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">Prepare</span><span class="token punctuation">(</span>&quot;Select <span class="token operator">*</span> <span class="token keyword">from</span> users where first_name<span class="token operator">=</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 值綁定</span>
<span class="token keyword">var</span> statement <span class="token operator">=</span> selectData<span class="token punctuation">.</span><span class="token function">Bind</span><span class="token punctuation">(</span><span class="token string">&quot;user1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//執行</span>
<span class="token keyword">var</span> res <span class="token operator">=</span> <span class="token keyword">await</span> session<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span>statement<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token operator">&lt;</span>string<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">foreach</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">var</span> item <span class="token keyword">in</span> res</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  result<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>GetValue<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">'last_name'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Reault：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token string">&quot;BB&quot;</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="delete"><a href="#delete" aria-hidden="true" class="header-anchor">#</a> Delete</h3> <p><strong>目標</strong>：刪除user1資料</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 建立連線，使用預設的 port</span>
<span class="token keyword">var</span> cluster <span class="token operator">=</span> Cluster<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">AddContactPoints</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 選擇使用的 keyspace</span>
<span class="token keyword">var</span> session <span class="token operator">=</span> cluster<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span><span class="token string">&quot;myTest&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 準備 update 資料</span>
<span class="token keyword">var</span> deleteData <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">Prepare</span><span class="token punctuation">(</span>&quot;Delete <span class="token keyword">from</span> users where first_name<span class="token operator">=</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 值綁定</span>
<span class="token keyword">var</span> statement <span class="token operator">=</span> deleteData<span class="token punctuation">.</span><span class="token function">Bind</span><span class="token punctuation">(</span><span class="token string">&quot;user1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//執行</span>
<span class="token keyword">await</span> session<span class="token punctuation">.</span><span class="token function">ExecuteAsync</span><span class="token punctuation">(</span>statement<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Reault：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>cqlsh:mytest<span class="token operator">&gt;</span> <span class="token keyword">select</span> * from <span class="token function">users</span><span class="token punctuation">;</span>

 first_name <span class="token operator">|</span> last_name
------------+-----------

<span class="token punctuation">(</span><span class="token number">1</span> rows<span class="token punctuation">)</span>
</code></pre></div><h2 id="批次執行-batch"><a href="#批次執行-batch" aria-hidden="true" class="header-anchor">#</a> 批次執行(batch)</h2> <p><strong>目標</strong>：批次執行 insert 與 update</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 建立連線，使用預設的 port</span>
<span class="token keyword">var</span> cluster <span class="token operator">=</span> Cluster<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">AddContactPoints</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 選擇使用的 keyspace</span>
<span class="token keyword">var</span> session <span class="token operator">=</span> cluster<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span><span class="token string">&quot;myTest&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 準備 insert 資料</span>
<span class="token keyword">var</span> addData <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">Prepare</span><span class="token punctuation">(</span><span class="token string">&quot;Insert Into users (first_name,last_name) values (?,?)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 準備 update 資料</span>
<span class="token keyword">var</span> updateData <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">Prepare</span><span class="token punctuation">(</span>&quot;Update users  <span class="token keyword">set</span> last_name<span class="token operator">=</span><span class="token operator">?</span> where first_name<span class="token operator">=</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 批次</span>
<span class="token keyword">var</span> batch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BatchStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>addData<span class="token punctuation">.</span><span class="token function">Bind</span><span class="token punctuation">(</span><span class="token string">&quot;user1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;AA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>updateData<span class="token punctuation">.</span><span class="token function">Bind</span><span class="token punctuation">(</span><span class="token string">&quot;BB&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;user1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//執行</span>
<span class="token keyword">await</span> session<span class="token punctuation">.</span><span class="token function">ExecuteAsync</span><span class="token punctuation">(</span>batch<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Reault：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>cqlsh:mytest<span class="token operator">&gt;</span> <span class="token keyword">select</span> * from <span class="token function">users</span><span class="token punctuation">;</span>

 first_name <span class="token operator">|</span> last_name
------------+-----------
      user1 <span class="token operator">|</span>        BB

<span class="token punctuation">(</span><span class="token number">1</span> rows<span class="token punctuation">)</span>

</code></pre></div><h2 id="自動綁定-mapping"><a href="#自動綁定-mapping" aria-hidden="true" class="header-anchor">#</a> 自動綁定(mapping)</h2> <p>建立 UDT (User Defined Types)</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">## 進入 cassandra component</span>
<span class="token operator">&gt;</span> cqlsh
cqlsh<span class="token operator">&gt;</span> use mytest
cqlsh:mytest<span class="token operator">&gt;</span> Create Type <span class="token function">users</span> <span class="token punctuation">(</span>first_name text,last_name text<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>建立 user class</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">users</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> string first_name <span class="token punctuation">{</span><span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> string last_name <span class="token punctuation">{</span><span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>設定自動對應方式：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">...</span><span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">(</span>省略<span class="token punctuation">)</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span>
session<span class="token punctuation">.</span>UserDefinedTypes<span class="token punctuation">.</span><span class="token function">Define</span><span class="token punctuation">(</span>
    UdtMap<span class="token punctuation">.</span>For<span class="token operator">&lt;</span>Users<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span><span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">(</span>省略<span class="token punctuation">)</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span>
</code></pre></div><div class="tip custom-block"><p>cassandra type 名稱與 C# class 名稱定義要一致</p></div> <p>手動對應方式：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">...</span><span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">(</span>省略<span class="token punctuation">)</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span>
session<span class="token punctuation">.</span>UserDefinedTypes<span class="token punctuation">.</span><span class="token function">Define</span><span class="token punctuation">(</span>
    UdtMap<span class="token punctuation">.</span>For<span class="token operator">&lt;</span>Users<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">Map</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token operator">=&gt;</span>s<span class="token punctuation">.</span>first_name<span class="token punctuation">,</span><span class="token string">&quot;first_name&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">Map</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token operator">=&gt;</span>s<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span><span class="token string">&quot;last_name&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span><span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">(</span>省略<span class="token punctuation">)</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span>
</code></pre></div><h2 id="分頁-paging"><a href="#分頁-paging" aria-hidden="true" class="header-anchor">#</a> 分頁(paging)</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">...</span><span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">(</span>省略<span class="token punctuation">)</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span>
<span class="token keyword">var</span> statement <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleStatment</span><span class="token punctuation">(</span><span class="token string">&quot;Select * from Users&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
statement<span class="token punctuation">.</span><span class="token function">SetPageSize</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> res <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span>statement<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">...</span><span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">(</span>省略<span class="token punctuation">)</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span>
</code></pre></div><p>只會抓取10筆資料</p> <div class="tip custom-block"><p>若要取得下一頁，需設定 PagingState，傳入型別為 byte[]。
因第一頁查詢 RowSet 返回具有 PagingState 的屬性，將帶入查詢下一頁時的 PagingState
<a href="http://hant.ask.helplib.com/asp.net/post_12663920" target="_blank" rel="noopener noreferrer">參考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <h2 id="使用-linq-查詢"><a href="#使用-linq-查詢" aria-hidden="true" class="header-anchor">#</a> 使用 LINQ 查詢</h2> <div class="language-js extra-class"><pre class="language-js"><code>Using Cassandra<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>Linq<span class="token punctuation">;</span>

<span class="token operator">...</span><span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">(</span>省略<span class="token punctuation">)</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span>

<span class="token keyword">var</span> users <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Table</span><span class="token operator">&lt;</span>Users<span class="token operator">&gt;</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> res <span class="token operator">=</span> users<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token parameter">d</span> <span class="token operator">=&gt;</span> d<span class="token punctuation">.</span>first_name <span class="token operator">==</span> <span class="token string">&quot;user1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> res<span class="token punctuation">;</span>
</code></pre></div><p>Reault：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span>
   <span class="token punctuation">{</span>
      <span class="token property">&quot;first_name&quot;</span><span class="token operator">:</span><span class="token string">&quot;user1&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;last_name&quot;</span><span class="token operator">:</span><span class="token string">&quot;BB&quot;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

</code></pre></div><h2 id="指定定查詢叢集"><a href="#指定定查詢叢集" aria-hidden="true" class="header-anchor">#</a> 指定定查詢叢集</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 建立連線，指定查詢叢集 n2</span>
<span class="token keyword">var</span> cluster <span class="token operator">=</span> Cluster<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">AddContactPoints</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">WithLoadBalancingPolicy</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DCAwareRoundRobinPolicy</span><span class="token punctuation">(</span><span class="token string">&quot;n2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span><span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">(</span>省略<span class="token punctuation">)</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span>

</code></pre></div><h2 id="指定傳輸壓縮"><a href="#指定傳輸壓縮" aria-hidden="true" class="header-anchor">#</a> 指定傳輸壓縮</h2> <p>Cassandra 可以透過設定修改二進制傳輸的壓縮級別，可以減少網路可以減少網路流量消耗與 CPU 的效能，尤其是當你有大量的資料傳輸負載。</p> <p>使用兩個第三方套件 <a href="https://github.com/lz4/lz4-java" target="_blank" rel="noopener noreferrer">LZ4<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 和 <a href="http://google.github.io/snappy/" target="_blank" rel="noopener noreferrer">Snappy<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 建立連線，指定查詢叢集 n2</span>
<span class="token keyword">var</span> cluster <span class="token operator">=</span> Cluster<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">AddContactPoints</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">)</span>
          <span class="token comment">// emum NoCompression = 0, nappy = 1, LZ4 = 2</span>
          <span class="token punctuation">.</span><span class="token function">WithCompression</span><span class="token punctuation">(</span>CompressionType<span class="token punctuation">.</span><span class="token constant">LZ4</span><span class="token punctuation">)</span> 
          <span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="tip custom-block"><p><a href="https://docs.datastax.com/en/developer/java-driver/2.1/manual/compression/" target="_blank" rel="noopener noreferrer">cassandra Compression 參考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <h2 id="最終一致性層級設定"><a href="#最終一致性層級設定" aria-hidden="true" class="header-anchor">#</a> 最終一致性層級設定</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">...</span><span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">(</span>省略<span class="token punctuation">)</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span>
<span class="token keyword">var</span> statement <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleStatement</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">SetConsistencyLevel</span><span class="token punctuation">(</span>ConsistencyLevel<span class="token punctuation">.</span>Quorum<span class="token punctuation">)</span> <span class="token comment">// 最終一致性</span>
  <span class="token punctuation">.</span><span class="token function">SetPageSize</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span><span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">(</span>省略<span class="token punctuation">)</span><span class="token operator">...</span><span class="token operator">...</span><span class="token operator">...</span>
</code></pre></div><p>更多一致性筆記請參考<a href="/Consistency">一致性章節</a></p> <div class="tip custom-block"><p><a href="https://docs.datastax.com/en/developer/java-driver/2.1/manual/compression/" target="_blank" rel="noopener noreferrer">cassandra Compression 參考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Cassandra/" class="prev router-link-active">Cassandra</a></span> <span class="next"><a href="/Cassandra/Security.html">安全性</a>→
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Cassandra/assets/js/app.e2f0342c.js" defer></script><script src="/Cassandra/assets/js/2.2effd283.js" defer></script><script src="/Cassandra/assets/js/11.31e7f102.js" defer></script>
  </body>
</html>
