(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{211:function(t,a,e){"use strict";e.r(a);var r=e(0),_=Object(r.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"cap-定理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cap-定理","aria-hidden":"true"}},[t._v("#")]),t._v(" CAP 定理")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("Ｃ")]),t._v(" 代表"),e("strong",[t._v("一致性")]),t._v("(Consistency)")]),t._v(" "),e("li",[e("strong",[t._v("Ａ")]),t._v(" 代表"),e("strong",[t._v("可用性")]),t._v("(Availability)")]),t._v(" "),e("li",[e("strong",[t._v("Ｐ")]),t._v(" 代表"),e("strong",[t._v("分區容錯性")]),t._v("(Parttion tolerance)")])]),t._v(" "),e("p",[e("em",[e("strong",[e("span",{staticStyle:{color:"red"}},[t._v("該定理認為只能滿足當中兩項，無法三項全部完成")])])])]),t._v(" "),e("h4",{attrs:{id:"犧牲一致性"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#犧牲一致性","aria-hidden":"true"}},[t._v("#")]),t._v(" 犧牲一致性")]),t._v(" "),e("p",[t._v("該系統稱AP系統，採用的是最終一致性的方式("),e("em",[t._v("Cassandra 認為可用性和分區容錯性比一致性更重要，所以採用此系統")]),t._v(")")]),t._v(" "),e("h4",{attrs:{id:"犧牲可用性"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#犧牲可用性","aria-hidden":"true"}},[t._v("#")]),t._v(" 犧牲可用性")]),t._v(" "),e("p",[t._v("該系統稱CP系統，在資料未同步前拒絕回應，通常在分散式交易中")]),t._v(" "),e("h4",{attrs:{id:"犧牲分區容錯性"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#犧牲分區容錯性","aria-hidden":"true"}},[t._v("#")]),t._v(" 犧牲分區容錯性")]),t._v(" "),e("p",[t._v("在分散式系統中該系統不存在，因無法擴展。")]),t._v(" "),e("div",{staticClass:"tip custom-block"},[e("p",[e("a",{attrs:{href:"https://zh.wikipedia.org/wiki/CAP%E5%AE%9A%E7%90%86",target:"_blank",rel:"noopener noreferrer"}},[t._v("維基百科(wiki) CAP 定理"),e("OutboundLink")],1)])]),t._v(" "),e("h2",{attrs:{id:"調整一致性-寫入"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#調整一致性-寫入","aria-hidden":"true"}},[t._v("#")]),t._v(" 調整一致性-寫入")]),t._v(" "),e("h4",{attrs:{id:"any"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#any","aria-hidden":"true"}},[t._v("#")]),t._v(" ANY")]),t._v(" "),e("p",[t._v("任意節點可寫入則操作成功，除非全部節點都掛了。「最低的Ｃ，最高到A」")]),t._v(" "),e("h4",{attrs:{id:"all"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#all","aria-hidden":"true"}},[t._v("#")]),t._v(" ALL")]),t._v(" "),e("p",[t._v("必須所有的節點都寫入才操作成功。「最高C，最低A」")]),t._v(" "),e("h4",{attrs:{id:"each-quorum"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#each-quorum","aria-hidden":"true"}},[t._v("#")]),t._v(" EACH_QUORUM")]),t._v(" "),e("p",[t._v("必須寫入每個數據中心的quorum(過半數)的數量的副本節點寫入成功，才操作成功。")]),t._v(" "),e("h4",{attrs:{id:"local-one"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#local-one","aria-hidden":"true"}},[t._v("#")]),t._v(" LOCAL_ONE")]),t._v(" "),e("p",[t._v("任何數據中心的副本節點寫入則操作成功。")]),t._v(" "),e("h4",{attrs:{id:"local-quorum"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#local-quorum","aria-hidden":"true"}},[t._v("#")]),t._v(" LOCAL_QUORUM")]),t._v(" "),e("p",[t._v("本定本定數據中心的quorum(過半數)的數量的副本節點成功寫入則操作成功。可避免跨區域數據中心。")]),t._v(" "),e("h4",{attrs:{id:"local-serial"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#local-serial","aria-hidden":"true"}},[t._v("#")]),t._v(" LOCAL_SERIAL")]),t._v(" "),e("p",[t._v("本定本定數據中心的quorum(過半數)的數量的副本節點，且有條件的，且有條件的寫入成功，才操作成功。")]),t._v(" "),e("h4",{attrs:{id:"one"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#one","aria-hidden":"true"}},[t._v("#")]),t._v(" ONE")]),t._v(" "),e("p",[t._v("任一個副本操作寫入則操作成功。最近的節點才則優先處理。")]),t._v(" "),e("h2",{attrs:{id:"讀取的一致性分類"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#讀取的一致性分類","aria-hidden":"true"}},[t._v("#")]),t._v(" 讀取的一致性分類")]),t._v(" "),e("h4",{attrs:{id:"all-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#all-2","aria-hidden":"true"}},[t._v("#")]),t._v(" ALL")]),t._v(" "),e("p",[t._v("所有節點副本都要回應才讀取成功。")]),t._v(" "),e("h4",{attrs:{id:"each-quorum-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#each-quorum-2","aria-hidden":"true"}},[t._v("#")]),t._v(" EACH_QUORUM")]),t._v(" "),e("p",[t._v("向每個數據中心的quorum(過半數)的數量的副本節點讀取都讀取都返回最新時間，才操作成功。")]),t._v(" "),e("h4",{attrs:{id:"serial"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#serial","aria-hidden":"true"}},[t._v("#")]),t._v(" SERIAL")]),t._v(" "),e("p",[t._v("讀取當前的數據，包含未認可的數據。")]),t._v(" "),e("h4",{attrs:{id:"local-serial-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#local-serial-2","aria-hidden":"true"}},[t._v("#")]),t._v(" LOCAL_SERIAL")]),t._v(" "),e("p",[t._v("限定讀取local的數據，包含未認可的數據。")]),t._v(" "),e("h4",{attrs:{id:"quorum"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#quorum","aria-hidden":"true"}},[t._v("#")]),t._v(" QUORUM")]),t._v(" "),e("p",[t._v("讀取每個數據中心的quorum(過半數)的數量的副本節點返回，才操作成功。")]),t._v(" "),e("h4",{attrs:{id:"local-quorum-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#local-quorum-2","aria-hidden":"true"}},[t._v("#")]),t._v(" LOCAL_QUORUM")]),t._v(" "),e("p",[t._v("讀取每個Local數據中心的quorum(過半數)的數量的副本節點返回，才操作成功。可避免跨區域數據中心。")]),t._v(" "),e("h4",{attrs:{id:"one-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#one-2","aria-hidden":"true"}},[t._v("#")]),t._v(" ONE")]),t._v(" "),e("p",[t._v("讀取由snitch決定的最近的副本返回結果。")]),t._v(" "),e("h4",{attrs:{id:"local-one-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#local-one-2","aria-hidden":"true"}},[t._v("#")]),t._v(" LOCAL_ONE")]),t._v(" "),e("p",[t._v("返回Local最近的副本返回結果。")]),t._v(" "),e("h4",{attrs:{id:"two"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#two","aria-hidden":"true"}},[t._v("#")]),t._v(" TWO")]),t._v(" "),e("p",[t._v("返回最近兩個數據。")]),t._v(" "),e("h4",{attrs:{id:"three"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#three","aria-hidden":"true"}},[t._v("#")]),t._v(" THREE")]),t._v(" "),e("p",[t._v("返回最近三個數據。")]),t._v(" "),e("div",{staticClass:"tip custom-block"},[e("p",[t._v("quorum(過半數) 計算方式（四捨五入）：")]),t._v(" "),e("p",[t._v("quorum = (副本數量 / 2)+1")]),t._v(" "),e("p",[t._v("如：")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("replication factor是3，quorum值為2-表示集群可以最多容忍1個節點掛掉")])]),t._v(" "),e("li",[e("p",[t._v("replication factor是6，quorum值為4-表示集群可以最多容忍2各節點掛掉。")])])])]),t._v(" "),e("div",{staticClass:"tip custom-block"},[e("p",[t._v("要確保讀寫一致性建議的公式為：")]),t._v(" "),e("p",[t._v("(nodes_written + nodes_read) > replication_factor")]),t._v(" "),e("p",[t._v("策略：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("nodes_written")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("nodes_read")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("replication_factor")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("consistency")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("ONE")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("QUORUM")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("3")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("span",{staticStyle:{color:"red"}},[t._v("false")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("ONE")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("ALL")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("3")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("span",{staticStyle:{color:"green"}},[t._v("true")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("ONE")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("ONE")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("3")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("span",{staticStyle:{color:"red"}},[t._v("false")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("QUORUM")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("QUORUM")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("3")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("span",{staticStyle:{color:"green"}},[t._v("true")])])])])])])])}),[],!1,null,null,null);a.default=_.exports}}]);